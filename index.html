<!DOCTYPE html>
<html lang="da">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>L√∏vbjerg Ordresystem</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

<style>
:root{
  --red:#d70000;
  --red-dark:#a80000;
  --green:#16a34a;
  --green-light:#4ade80;
  --bg:#f3f5fb;
  --card:#ffffff;
  --text:#111827;
  --muted:#6b7280;
  --border:#e5e7eb;
  --radius:18px;
}

*{box-sizing:border-box;}

body{
  margin:0;
  font-family:'Inter',system-ui,sans-serif;
  background:radial-gradient(circle at top left,#ffffff 0%,#f2f4fa 45%,#eceff7 100%);
  color:var(--text);
  padding:26px;
}

/* HEADER */
.app-header{
  background:linear-gradient(135deg,var(--red),#ff4d4d);
  color:white;
  padding:28px;
  border-radius:30px;
  box-shadow:0 22px 45px rgba(215,0,0,.35);
  margin-bottom:50px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  flex-wrap:wrap;
  gap:12px;
}

.app-header h1{margin:0;font-size:2rem;}
.sub{opacity:.9;}
.date{font-weight:700;}

/* TABS */
.tabs{
  display:flex;
  gap:10px;
  background:white;
  padding:8px;
  border-radius:22px;
  width:fit-content;
  box-shadow:0 10px 30px rgba(0,0,0,.08);
  margin-bottom:32px;
}

.tabs button{
  all:unset;
  cursor:pointer;
  padding:12px 22px;
  border-radius:16px;
  font-weight:700;
  color:var(--muted);
  transition:.25s;
}

.tabs button.active{
  background:linear-gradient(135deg,var(--red),#ff4d4d);
  color:white;
  box-shadow:0 8px 18px rgba(215,0,0,.45);
}

/* TOOLBAR */
.top-bar{
  display:flex;
  flex-wrap:wrap;
  gap:14px;
  margin-bottom:22px;
}

input, select{
  padding:14px 16px;
  border-radius:14px;
  border:1px solid var(--border);
  font-size:1rem;
  width:100%;
}

.btn{
  border:none;
  border-radius:14px;
  padding:14px 20px;
  font-weight:700;
  cursor:pointer;
  background:linear-gradient(135deg,var(--red),#ff4d4d);
  color:white;
  box-shadow:0 10px 22px rgba(215,0,0,.35);
  transition:.2s;
}

.btn:hover{transform:translateY(-1px);box-shadow:0 14px 26px rgba(215,0,0,.4);}
.btn:active{transform:scale(.96);}

.btn.secondary{
  background:white;
  color:var(--text);
  box-shadow:0 8px 18px rgba(0,0,0,.08);
}

.btn.success{
  background:linear-gradient(135deg,var(--green),var(--green-light));
  box-shadow:0 10px 22px rgba(22,163,74,.35);
}

/* SECTIONS */
.section{
  background:white;
  border-radius:28px;
  padding:22px;
  box-shadow:0 12px 35px rgba(0,0,0,.08);
  margin-bottom:28px;
}

.order,.customer{
  background:linear-gradient(180deg,#ffffff,#f7f8fc);
  border:1px solid var(--border);
  border-radius:18px;
  padding:16px;
  margin-bottom:12px;
  transition:.2s;
}

.order:hover{transform:translateY(-2px);box-shadow:0 10px 22px rgba(0,0,0,.08);}
.order.done{opacity:.4;filter:grayscale(1);}

.actions{
  margin-top:12px;
  display:flex;
  gap:8px;
  flex-wrap:wrap;
}

.actions button{
  font-size:.75rem;
  padding:8px 12px;
  border-radius:10px;
  border:none;
  font-weight:700;
  cursor:pointer;
  background:linear-gradient(135deg,var(--red),#ff4d4d);
  color:white;
  box-shadow:0 6px 14px rgba(215,0,0,.35);
  transition:.2s;
}

.actions button:nth-child(2){
  background:linear-gradient(135deg,var(--green),var(--green-light));
  box-shadow:0 6px 14px rgba(22,163,74,.35);
}
.actions button:nth-child(3){
  background:linear-gradient(135deg,#111827,#374151);
  box-shadow:0 6px 14px rgba(0,0,0,.4);
}

.actions button:hover{transform:translateY(-1px);}
.actions button:active{transform:scale(.95);}

/* MODAL */
.modal-bg{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.6);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:1000;
  backdrop-filter: blur(4px);
}

.modal{
  background:linear-gradient(180deg,#ffffff,#f6f7fb);
  border-radius:28px;
  padding:28px;
  width:100%;
  max-width:520px;
  display:flex;
  flex-direction:column;
  gap:14px;
  box-shadow:0 30px 60px rgba(0,0,0,.35);
  animation:pop .25s ease;
}

@keyframes pop{from{transform:scale(.9);opacity:0}to{transform:scale(1);opacity:1}}

.modal h3{margin:0 0 6px 0;font-size:1.4rem;}

.modal label{
  display:flex;
  align-items:center;
  gap:10px;
  font-weight:600;
}

.modal input[type="checkbox"]{
  width:22px;
  height:22px;
  accent-color:var(--red);
}

ul{list-style:none;padding:0;margin:0;max-height:160px;overflow:auto;}
li{
  background:#f3f4f6;
  padding:6px 10px;
  border-radius:10px;
  margin-bottom:6px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
li button{
  background:#ef4444;
  border:none;
  color:white;
  border-radius:8px;
  padding:4px 8px;
  cursor:pointer;
}

.tab-content{display:none;}
.tab-content.active{display:block;}
</style>
</head>

<body>

<div class="app-header">
  <div>
    <h1>L√∏vbjerg Ordresystem</h1>
    <div class="sub">Ordrer & faste kunder</div>
  </div>
  <div class="date" id="currentDate"></div>
</div>

<div class="tabs">
  <button class="active" onclick="showTab('ordersTab',this)">üì¶ Ordrer</button>
  <button onclick="showTab('customersTab',this)">üë§ Faste kunder</button>
</div>

<div id="ordersTab" class="tab-content active">
  <div class="top-bar">
    <button class="btn" onclick="showAddModal()">‚ûï Opret ordre</button>
    <input id="search" placeholder="S√∏g kunde..." oninput="renderOrders()">
    <button class="btn secondary" onclick="printToday()">üñ®Ô∏è Print</button>
    <button class="btn secondary" onclick="clearAllData()">üóëÔ∏è Ryd</button>
  </div>
  <div id="orders-today" class="section"></div>
  <div id="orders-future" class="section"></div>
</div>

<div id="customersTab" class="tab-content">
  <div class="top-bar">
    <button class="btn" onclick="showAddModal()">‚ûï Tilf√∏j fast kunde</button>
  </div>
  <div id="customerContainer" class="section"></div>
</div>

<!-- MODALS -->
<div id="addModal" class="modal-bg">
  <div class="modal">
    <h3>Opret ordre</h3>

    <input id="addCustomer" placeholder="Firmanavn">

    <ul id="productList"></ul>

    <input id="addProductInput" placeholder="Tilf√∏j produkt">
    <button class="btn success" onclick="addProduct()">‚ûï Tilf√∏j produkt</button>

    <div style="display:flex;gap:10px">
      <input id="addDate" type="date">
      <input id="addTime" type="time">
    </div>

    <label>
      <input type="checkbox" id="addRepeat">
      Fast ugentlig aftale
    </label>

    <div style="display:flex;gap:10px;margin-top:10px">
      <button class="btn" onclick="submitAddOrder()">Gem</button>
      <button class="btn secondary" onclick="hideAddModal()">Annuller</button>
    </div>
  </div>
</div>

<div id="readyModal" class="modal-bg">
  <div class="modal">
    <h3>Klargjort</h3>
    <input id="readyNoteInput" placeholder="Hvor er varerne klargjort?">
    <div style="display:flex;gap:10px">
      <button class="btn" onclick="submitReady()">Gem</button>
      <button class="btn secondary" onclick="hideReadyModal()">Annuller</button>
    </div>
  </div>
</div>

<script>
function updateDate(){
  document.getElementById("currentDate").innerText =
    new Date().toLocaleDateString("da-DK",{weekday:"long",day:"numeric",month:"long",year:"numeric"});
}
updateDate();

let orders = JSON.parse(localStorage.getItem("orders")||"[]");
let nextId = orders.length ? Math.max(...orders.map(o=>o.id))+1 : 1;
let tempProducts=[], readyId=null;

function save(){localStorage.setItem("orders",JSON.stringify(orders));}
function today(){return new Date().toISOString().split("T")[0];}
function addDays(d,n){const x=new Date(d);x.setDate(x.getDate()+n);return x.toISOString().split("T")[0];}
function weekday(d){return new Date(d).getDay();}

function showTab(tab,btn){
  document.querySelectorAll(".tab-content").forEach(t=>t.classList.remove("active"));
  document.querySelectorAll(".tabs button").forEach(b=>b.classList.remove("active"));
  document.getElementById(tab).classList.add("active");
  btn.classList.add("active");
  if(tab==="customersTab") renderCustomers();
}

function renderOrders(){
  const todayBox=document.getElementById("orders-today");
  const futureBox=document.getElementById("orders-future");
  todayBox.innerHTML="<h3>üìç Afhentes i dag</h3>";
  futureBox.innerHTML="<h3>üìÜ Kommende afhentninger (7 dage)</h3>";

  const q=document.getElementById("search").value.toLowerCase();
  let t=0,f=0;
  const next7=[...Array(7)].map((_,i)=>addDays(today(),i+1));

  orders.forEach(o=>{
    if(!o.customer.toLowerCase().includes(q)) return;

    if(o.date===today()){todayBox.appendChild(orderCard(o,true,false));t++;}

    if(o.repeat){
      next7.forEach(d=>{
        if(weekday(d)===weekday(o.date)){
          futureBox.appendChild(orderCard({...o,date:d},false,true));f++;
        }
      });
    } else if(o.date>today()){
      futureBox.appendChild(orderCard(o,false,false));f++;
    }
  });

  if(!t) todayBox.innerHTML+="<p>Ingen ordrer i dag</p>";
  if(!f) futureBox.innerHTML+="<p>Ingen kommende ordrer</p>";
}

function orderCard(o,isToday,isGenerated){
  const div=document.createElement("div");
  div.className="order"+(o.done?" done":"");
  div.innerHTML=`
    <strong>${o.customer}</strong><br>
    ${o.products.join(", ")}<br>
    Afhentning: ${o.date} ${o.time||""}
    ${o.readyNote?`<div style="opacity:.7;margin-top:6px">üì¶ ${o.readyNote}</div>`:""}
    ${isToday && !isGenerated?`
    <div class="actions">
      <button onclick="markReady(${o.id})">Klargjort</button>
      <button onclick="toggleDone(${o.id})">Afhentet</button>
      <button onclick="deleteOrder(${o.id})">Slet</button>
    </div>`:""}
  `;
  return div;
}

function toggleDone(id){orders.find(o=>o.id===id).done^=1;save();renderOrders();}
function deleteOrder(id){if(confirm("Slet ordre?")){orders=orders.filter(o=>o.id!==id);save();renderOrders();renderCustomers();}}
function markReady(id){readyId=id;readyNoteInput.value="";readyModal.style.display="flex";}
function submitReady(){orders.find(o=>o.id===readyId).readyNote=readyNoteInput.value;hideReadyModal();save();renderOrders();}
function hideReadyModal(){readyModal.style.display="none";}

function showAddModal(){
  tempProducts=[];
  addCustomer.value="";
  addProductInput.value="";
  addDate.value=today();
  addTime.value="";
  addRepeat.checked=false;
  renderTemp();
  addModal.style.display="flex";
}

function hideAddModal(){addModal.style.display="none";}

function addProduct(){
  const v=addProductInput.value.trim();
  if(!v) return;
  tempProducts.push(v);
  addProductInput.value="";
  renderTemp();
}

function renderTemp(){
  productList.innerHTML="";
  tempProducts.forEach((p,i)=>{
    const li=document.createElement("li");
    li.innerHTML=`${p}<button onclick="tempProducts.splice(${i},1);renderTemp()">x</button>`;
    productList.appendChild(li);
  });
}

function submitAddOrder(){
  if(!addCustomer.value.trim()||!tempProducts.length) return alert("Udfyld alle felter");
  orders.push({
    id:nextId++,
    customer:addCustomer.value.trim(),
    products:[...tempProducts],
    date:addDate.value,
    time:addTime.value,
    repeat:addRepeat.checked,
    done:false,
    readyNote:""
  });
  save(); hideAddModal(); renderOrders(); renderCustomers();
}

function renderCustomers(){
  customerContainer.innerHTML="<h3>üë§ Faste kunder</h3>";
  const list=orders.filter(o=>o.repeat);
  if(!list.length) return customerContainer.innerHTML+="<p>Ingen faste kunder</p>";
  list.forEach(o=>{
    const div=document.createElement("div");
    div.className="customer";
    div.innerHTML=`<strong>${o.customer}</strong><br>${o.products.join(", ")}<br>${new Date(o.date).toLocaleDateString("da-DK",{weekday:"long"})}`;
    customerContainer.appendChild(div);
  });
}

function printToday(){
  const list=orders.filter(o=>o.date===today());
  const w=window.open("");
  w.document.write("<h1>Dagens ordrer</h1>");
  list.forEach(o=>w.document.write(`<p><strong>${o.customer}</strong><br>${o.products.join(", ")}<br>${o.time||""}</p><hr>`));
  w.print();
}

function clearAllData(){if(confirm("Slet ALT?")){localStorage.clear();location.reload();}}

renderOrders(); renderCustomers();
</script>

</body>
</html>
